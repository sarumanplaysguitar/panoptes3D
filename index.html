<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>panoptes3D (Demo)</title>
  <style>
    html {
      box-sizing: border-box;
    }

    /* *,
    *:before,
    *:after {
      box-sizing: inherit;
      overflow: hidden;
    } */

    body {
      margin: 0;
      background: #3A3A3A;
      box-sizing: inherit;
      overflow: hidden;
    }

    .frame {
      /* padding: 50px; */
      display: flex;
      width: 100vw;
      height: 100vh;
      /* box-sizing: inherit;
      overflow: hidden; */
    }

    .frame>* {
      flex: 1 1 100%;
    }

    canvas {
      width: 100%;
      height: 100%;
    }
  </style>
</head>

<body>

  <div class="frame">
    <div class="container">
      <canvas></canvas>
    </div>
  </div>

  <script type="text/javascript" src="js/three.min.js"></script>
  <script type="text/javascript" src="js/OrbitControls.js"></script>
  <script type="text/javascript" src="js/GLTFLoader.js"></script>
  <script type="text/javascript" src="js/dat.gui.min.js"></script>

  <script type="text/javascript">

    const pi = Math.PI;

    function deg_to_rad(deg) {
      return deg * pi / 180;
    }

    // FPS stats (by mrdoob) üìä

    javascript: (function () { var script = document.createElement('script'); script.onload = function () { var stats = new Stats(); document.body.appendChild(stats.dom); requestAnimationFrame(function loop() { stats.update(); requestAnimationFrame(loop) }); }; script.src = 'http://mrdoob.github.io/stats.js/build/stats.min.js'; document.head.appendChild(script); })()

    console.log(`using three.js r${THREE.REVISION}`)

    // Camera settings üé•

    const renderer = new THREE.WebGLRenderer({ canvas: document.querySelector("canvas"), alpha: true, antialias: true });
    // renderer.outputEncoding = THREE.sRGBEncoding;
    const camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 1, 1000);
    camera.position.set(30, 30, 30);
    // controls = new THREE.PointerLockControls(camera, renderer.domElement);
    var controls = new THREE.OrbitControls(camera, renderer.domElement);
    controls.enablePan = false;

    // Scene setup üñº

    const scene = new THREE.Scene();

    // { scene.fog = new THREE.Fog(0x7ce6d9, 30, 350); }

    var axesHelper = new THREE.AxesHelper(5);
    scene.add(axesHelper);

    // var prevTime = performance.now();
    // var velocity = new THREE.Vector3();
    // var direction = new THREE.Vector3();
    // var vertex = new THREE.Vector3();
    // var color = new THREE.Color();


    // Lighting üí°

    const light1 = new THREE.PointLight(0xff6200, 0.5, 0);
    light1.position.set(-100, 100, 30);
    scene.add(light1);

    const light2 = new THREE.PointLight(0xff6200, 0.5, 0);
    light2.position.set(100, 100, 30);
    scene.add(light2);


    const light3 = new THREE.PointLight(0xff6200, 0.5, 0);
    scene.add(light3);

    var directionalLight = new THREE.DirectionalLight(0xffffff, 2);
    scene.add(directionalLight);

    var light = new THREE.AmbientLight(0xffd6ff, intensity = 0.75); // soft warm light
    scene.add(light);


    // Materials üé®
    // var newMaterial = new THREE.MeshStandardMaterial({ color: 0xff0000 });


    // Objects üî≠

    var loader = new THREE.GLTFLoader();

    // loader.load('assets/object.glb', onLoad);

    function onLoad(gltf) {
      console.log(gltf);
      model = gltf.scene;

      scene.add(gltf.scene.children[0]);
    }

    // Test box üì¶
    const box_geo = new THREE.BoxGeometry(1, 1, 1);
    const box_mat = new THREE.MeshPhongMaterial({
      color: 0x555555,
      specular: 0xffffff,
      shininess: 5,
      flatShading: THREE.SmoothShading
    });
    const test_box = new THREE.Mesh(box_geo, box_mat);
    test_box.translateY(2);
    test_box.translateX(2);
    scene.add(test_box);

    // Test box 2 üì¶
    const box2_geo = new THREE.BoxGeometry(1, 1, 1);
    const box2_mat = new THREE.MeshPhongMaterial({
      color: 0x555555,
      specular: 0xffffff,
      shininess: 5,
      flatShading: THREE.SmoothShading
    });
    const test_box2 = new THREE.Mesh(box2_geo, box2_mat);
    // test_box2.translateY(1);
    // test_box2.translateX(2);
    test_box2.scale.x = 2;
    test_box2.scale.z = 2;
    // test_box2.parent = test_box;

    scene.add(test_box2);


    test_box.add(test_box2);


    var guiControls = new function () {
      this.rotationX = 0.;
      this.rotationY = 0.;
      this.rotationZ = 0.;
      this.childrotationX = 0.;
      this.childrotationY = 0.;
      this.childrotationZ = 0.;
    }

    // Demo input GUI¬†üïπ
    var gui = new dat.GUI();
    gui.add(guiControls, 'rotationX', 0, 360);
    gui.add(guiControls, 'rotationY', 0, 360);
    gui.add(guiControls, 'rotationZ', 0, 360);
    gui.add(guiControls, 'childrotationX', 0, 360);
    gui.add(guiControls, 'childrotationY', 0, 360);
    gui.add(guiControls, 'childrotationZ', 0, 360);


    // Resize canvas with window ‚ÜóÔ∏è

    function resizeCanvasToDisplaySize() {
      const canvas = renderer.domElement;
      const width = canvas.clientWidth;
      const height = canvas.clientHeight;

      if (canvas.width !== width || canvas.height !== height) {
        console.log(`canvas dimensions: ${width}x${height}`)
        renderer.setSize(width, height, false);
        camera.aspect = width / height;
        camera.updateProjectionMatrix();
      }
    }

    // Animate here üé¨

    function animate(time) {
      var time = performance.now();
      time *= 0.001; // convert ms to seconds

      resizeCanvasToDisplaySize();

      test_box.rotation.x = deg_to_rad(guiControls.rotationX);
      test_box.rotation.y = deg_to_rad(guiControls.rotationY);
      test_box.rotation.z = deg_to_rad(guiControls.rotationZ);
      test_box2.rotation.x = deg_to_rad(guiControls.childrotationX);
      test_box2.rotation.y = deg_to_rad(guiControls.childrotationY);
      test_box2.rotation.z = deg_to_rad(guiControls.childrotationZ);
      // mesh.rotation.y = time * 1;
      renderer.render(scene, camera);
      requestAnimationFrame(animate);
    }

    requestAnimationFrame(animate);

  </script>
</body>

</html>